{"version":3,"sources":["../src/testers/brotli.js","../src/testers/gzip.js","../src/testers/none.js","../src/testers/shared.js","../src/testers/index.js","../src/utils/size.js","../src/config/load-config.js","../src/files/resolve-files.js","../src/core/run-checks.js"],"names":["promisify","path","fs"],"mappings":"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","file":"index.js","sourcesContent":["import { promisify } from \"node:util\";\nimport { brotliCompress, constants } from \"node:zlib\";\n\nconst brotliAsync = promisify(brotliCompress);\n\nexport const brotliTester = {\n  id: \"brotli\",\n  label: \"brotli\",\n  measure: async (buffer) => {\n    const compressed = await brotliAsync(buffer, {\n      params: {\n        [constants.BROTLI_PARAM_MODE]: constants.BROTLI_MODE_TEXT,\n        [constants.BROTLI_PARAM_QUALITY]: 11\n      }\n    });\n\n    return { bytes: compressed.byteLength };\n  }\n};\n\n","import { promisify } from \"node:util\";\nimport { gzip } from \"node:zlib\";\n\nconst gzipAsync = promisify(gzip);\n\nexport const gzipTester = {\n  id: \"gzip\",\n  label: \"gzip\",\n  measure: async (buffer) => {\n    const compressed = await gzipAsync(buffer);\n    return { bytes: compressed.byteLength };\n  }\n};\n\n","export const noneTester = {\n  id: \"none\",\n  label: \"raw\",\n  measure: async (buffer) => ({ bytes: buffer.byteLength })\n};\n\n","export const DEFAULT_TESTER_ID = \"gzip\";\nexport const NORMALIZED_TOKENS = new Set([\"none\", \"gzip\", \"brotli\"]);\n\nexport const createTester = ({ id, label, measure }) => {\n  if (!id || typeof measure !== \"function\") {\n    throw new Error(\"Tester definitions must include an id and a measure function\");\n  }\n\n  return {\n    id,\n    label: label || id,\n    measure\n  };\n};\n\nexport const normalizeTesterId = (value) => {\n  if (!value) {\n    return DEFAULT_TESTER_ID;\n  }\n\n  const normalized = value.toLowerCase();\n  return NORMALIZED_TOKENS.has(normalized) ? normalized : value;\n};\n\n","import { brotliTester } from \"./brotli.js\";\nimport { gzipTester } from \"./gzip.js\";\nimport { noneTester } from \"./none.js\";\nimport { DEFAULT_TESTER_ID, createTester, normalizeTesterId } from \"./shared.js\";\n\nexport { DEFAULT_TESTER_ID } from \"./shared.js\";\n\nconst builtinTesters = new Map(\n  [noneTester, gzipTester, brotliTester].map((tester) => [tester.id, createTester(tester)])\n);\n\nexport const createTesterRegistry = (customTesters) => {\n  const registry = new Map(builtinTesters);\n\n  if (customTesters) {\n    const entries = customTesters instanceof Map ? customTesters.entries() : Object.entries(customTesters);\n\n    for (const [, tester] of entries) {\n      const normalizedTester = createTester(tester);\n      registry.set(normalizedTester.id, normalizedTester);\n    }\n  }\n\n  return registry;\n};\n\nexport const getTester = (testerId, registry) => {\n  const normalized = normalizeTesterId(testerId);\n  const tester = registry.get(normalized);\n\n  if (!tester) {\n    throw new Error(`Unknown tester \"${testerId}\"`);\n  }\n\n  return tester;\n};\n\nexport const listTesters = () =>\n  Array.from(builtinTesters.values()).map((tester) => ({\n    id: tester.id,\n    label: tester.label\n  }));\n\n","import prettyBytes from \"pretty-bytes\";\n\nconst UNIT_FACTORS = {\n  b: 1,\n  byte: 1,\n  bytes: 1,\n  k: 1_000,\n  kb: 1_000,\n  kib: 1_024,\n  m: 1_000_000,\n  mb: 1_000_000,\n  mib: 1_048_576,\n  g: 1_000_000_000,\n  gb: 1_000_000_000,\n  gib: 1_073_741_824\n};\n\nexport const formatBytes = (value) => prettyBytes(Math.max(0, value), { binary: false });\n\nexport const formatDiff = (diff) => {\n  if (diff === 0) {\n    return \"0 B\";\n  }\n\n  const sign = diff > 0 ? \"+\" : \"-\";\n  return `${sign}${formatBytes(Math.abs(diff))}`;\n};\n\nexport const parseSize = (value) => {\n  if (typeof value === \"number\" && Number.isFinite(value)) {\n    return value;\n  }\n\n  if (typeof value !== \"string\") {\n    throw new Error(`Unsupported size value. Expected string or number, received: ${typeof value}`);\n  }\n\n  const normalized = value.trim().toLowerCase().replace(/\\s+/g, \"\");\n  const match = normalized.match(/^(-?\\d+(?:\\.\\d+)?)([a-z]+)?$/i);\n\n  if (!match) {\n    throw new Error(`Invalid size format: \"${value}\"`);\n  }\n\n  const [, rawNumber, rawUnit] = match;\n  const unit = rawUnit || \"b\";\n  const factor = UNIT_FACTORS[unit];\n\n  if (!factor) {\n    throw new Error(`Unknown size unit \"${unit}\" in value \"${value}\"`);\n  }\n\n  const numericValue = Number(rawNumber);\n\n  if (!Number.isFinite(numericValue)) {\n    throw new Error(`Invalid numeric size: \"${value}\"`);\n  }\n\n  return Math.round(numericValue * factor);\n};\n\nexport const toDisplaySize = (original, bytes) => {\n  if (typeof original === \"string\" && original.trim().length) {\n    return original.trim();\n  }\n\n  return formatBytes(bytes);\n};\n\n","import fs from \"node:fs/promises\";\nimport path from \"node:path\";\n\nimport { z } from \"zod\";\n\nimport { DEFAULT_TESTER_ID } from \"../testers/index.js\";\nimport { formatBytes, parseSize, toDisplaySize } from \"../utils/size.js\";\n\nconst NORMALIZED_CONFIG_FLAG = Symbol.for(\"overweight.normalizedConfig\");\n\nconst FileSchema = z.object({\n  path: z.string().min(1, \"Each file rule requires a path or glob pattern\"),\n  maxSize: z.union([z.string(), z.number()]),\n  compression: z.string().optional(),\n  label: z.string().optional()\n});\n\nconst ConfigSchema = z.object({\n  root: z.string().optional(),\n  defaultCompression: z.string().optional(),\n  files: z.array(FileSchema).min(1, \"Provide at least one file rule to check\")\n});\n\nconst ensureArrayConfig = (input) => (Array.isArray(input) ? { files: input } : input);\n\nconst fileExists = async (targetPath) => {\n  try {\n    await fs.access(targetPath);\n    return true;\n  } catch {\n    return false;\n  }\n};\n\nconst readJson = async (targetPath) => {\n  const raw = await fs.readFile(targetPath, \"utf-8\");\n\n  try {\n    return JSON.parse(raw);\n  } catch (error) {\n    throw new Error(`Failed to parse JSON file at ${targetPath}: ${error.message}`);\n  }\n};\n\nexport const isNormalizedConfig = (config) => Boolean(config?.[NORMALIZED_CONFIG_FLAG]);\n\nexport const normalizeConfig = (rawConfig, { cwd, source } = {}) => {\n  const configRoot = path.resolve(cwd || process.cwd());\n  const parsed = ConfigSchema.parse(ensureArrayConfig(rawConfig));\n  const defaultCompression = (parsed.defaultCompression || DEFAULT_TESTER_ID).toLowerCase();\n\n  const normalized = {\n    root: parsed.root ? path.resolve(configRoot, parsed.root) : configRoot,\n    defaultCompression,\n    files: parsed.files.map((file) => {\n      const maxBytes = parseSize(file.maxSize);\n\n      if (maxBytes < 0) {\n        throw new Error(`maxSize for \"${file.path}\" must be greater than or equal to zero`);\n      }\n\n      const compression = (file.compression || defaultCompression).toLowerCase();\n\n      return {\n        path: file.path,\n        pattern: file.path,\n        label: file.label || file.path,\n        compression,\n        maxBytes,\n        maxSizeInput: file.maxSize,\n        maxDisplay: toDisplaySize(file.maxSize, maxBytes),\n        maxFormatted: formatBytes(maxBytes)\n      };\n    }),\n    source: source || { type: \"inline\" }\n  };\n\n  normalized[NORMALIZED_CONFIG_FLAG] = true;\n  return normalized;\n};\n\nexport const loadConfig = async ({ cwd = process.cwd(), configPath, inlineConfig } = {}) => {\n  const root = path.resolve(cwd);\n\n  if (inlineConfig) {\n    return normalizeConfig(inlineConfig, { cwd: root, source: { type: \"inline\" } });\n  }\n\n  const tryLoadConfig = async (candidatePath) => {\n    if (!(await fileExists(candidatePath))) {\n      return null;\n    }\n\n    const data = await readJson(candidatePath);\n    return normalizeConfig(data, { cwd: root, source: { type: \"file\", location: candidatePath } });\n  };\n\n  if (configPath) {\n    const absoluteConfig = path.resolve(root, configPath);\n    const loaded = await tryLoadConfig(absoluteConfig);\n\n    if (!loaded) {\n      throw new Error(`Could not find config file at \"${absoluteConfig}\"`);\n    }\n\n    return loaded;\n  }\n\n  const defaultConfigPaths = [\"overweight.json\", \"overweight.config.json\"].map((file) =>\n    path.join(root, file)\n  );\n\n  for (const candidate of defaultConfigPaths) {\n    const loaded = await tryLoadConfig(candidate);\n\n    if (loaded) {\n      return loaded;\n    }\n  }\n\n  const packageJsonPath = path.join(root, \"package.json\");\n\n  if (await fileExists(packageJsonPath)) {\n    const pkgJson = await readJson(packageJsonPath);\n    const field = pkgJson.overweight;\n\n    if (field) {\n      return normalizeConfig(ensureArrayConfig(field), {\n        cwd: root,\n        source: { type: \"package\", location: packageJsonPath }\n      });\n    }\n  }\n\n  throw new Error(\n    \"No overweight configuration found. Create an overweight.json (or overweight.config.json) file, add an `overweight` field to package.json, or pass --config.\"\n  );\n};\n\nexport const NORMALIZED_FLAG = NORMALIZED_CONFIG_FLAG;\n\n","import path from \"node:path\";\n\nimport fg from \"fast-glob\";\n\nexport const resolveFiles = async (pattern, { root }) => {\n  const matches = await fg(pattern, {\n    cwd: root,\n    absolute: true,\n    dot: true,\n    onlyFiles: true\n  });\n\n  const unique = Array.from(new Set(matches));\n\n  return unique.map((absolutePath) => ({\n    absolutePath,\n    relativePath: path.relative(root, absolutePath) || path.basename(absolutePath)\n  }));\n};\n\n","import fs from \"node:fs/promises\";\n\nimport { normalizeConfig, isNormalizedConfig } from \"../config/load-config.js\";\nimport { resolveFiles } from \"../files/resolve-files.js\";\nimport { createTesterRegistry, getTester } from \"../testers/index.js\";\nimport { formatBytes, formatDiff } from \"../utils/size.js\";\n\nconst buildMissingResult = (rule) => ({\n  pattern: rule.pattern,\n  label: rule.label,\n  filePath: rule.pattern,\n  tester: rule.compression,\n  testerLabel: rule.compression,\n  size: null,\n  sizeFormatted: \"N/A\",\n  maxSizeFormatted: rule.maxFormatted,\n  maxSize: rule.maxBytes,\n  diff: null,\n  diffFormatted: \"N/A\",\n  passed: false,\n  error: \"No files matched this pattern\"\n});\n\nconst markNormalized = (config) =>\n  normalizeConfig(config, {\n    cwd: config.root || process.cwd(),\n    source: config.source || { type: \"inline\" }\n  });\n\nexport const runChecks = async (rawConfig, options = {}) => {\n  const normalizedConfig = isNormalizedConfig(rawConfig) ? rawConfig : markNormalized(rawConfig);\n  const registry = createTesterRegistry(options.testers);\n\n  const results = [];\n\n  for (const fileRule of normalizedConfig.files) {\n    const tester = getTester(fileRule.compression || normalizedConfig.defaultCompression, registry);\n    const matches = await resolveFiles(fileRule.pattern, { root: normalizedConfig.root });\n\n    if (!matches.length) {\n      results.push(buildMissingResult(fileRule));\n      continue;\n    }\n\n    for (const match of matches) {\n      const buffer = await fs.readFile(match.absolutePath);\n      const measurement = await tester.measure(buffer, {\n        filePath: match.absolutePath,\n        pattern: fileRule.pattern\n      });\n\n      const size = Number(measurement?.bytes);\n\n      if (!Number.isFinite(size)) {\n        throw new Error(`Tester \"${tester.id}\" did not return a numeric size for \"${match.relativePath}\"`);\n      }\n\n      const diff = size - fileRule.maxBytes;\n      const passed = diff <= 0;\n\n      results.push({\n        pattern: fileRule.pattern,\n        label: fileRule.label,\n        filePath: match.relativePath,\n        absolutePath: match.absolutePath,\n        tester: tester.id,\n        testerLabel: tester.label,\n        size,\n        sizeFormatted: formatBytes(size),\n        maxSizeFormatted: fileRule.maxFormatted,\n        maxSize: fileRule.maxBytes,\n        diff,\n        diffFormatted: formatDiff(diff),\n        passed\n      });\n    }\n  }\n\n  const failures = results.filter((entry) => !entry.passed || entry.error);\n\n  return {\n    results,\n    stats: {\n      files: results.length,\n      failures,\n      hasFailures: failures.length > 0,\n      hasErrors: failures.some((entry) => Boolean(entry.error))\n    }\n  };\n};\n\n"]}